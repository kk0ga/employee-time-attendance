---
applyTo: "src/lib/**.ts"
---

# Microsoft Graph / SharePoint List アクセス指針

## クライアント設計
- Graph呼び出しは /src/lib/graph に集約し、UI層でfetchを散らさない
- サイトID/リストIDなどは設定として切り出し、コード直書きを避ける

## パフォーマンス
- 一覧取得は必要列のみ取得（fields絞り込み、ページング）
- 監視/一覧更新は差分取得（Modified以降）を優先し、フルスキャンを避ける

## レート制限
- 429/503は必ずリトライ（指数バックオフ + リトライ上限）
- 失敗時のユーザー表示は日本語で簡潔に
