---
applyTo: "src/domain/**.ts"
---

# 勤怠データモデル（監査・改ざん耐性）

## 基本原則
- 打刻イベント（原本）は追記型（append-only）を基本にする
- 集計結果（日次/月次）は再計算可能な形で保持し、「計算バージョン」と「丸めルール」を記録する

## ロックと修正
- 月次承認後は対象期間をロック状態にする
- ロック後の変更は「修正申請 → 承認 → 差分反映」のみにし、履歴（誰が/いつ/何を）を必ず残す

## 履歴
- 承認/却下/差戻しは必ずログ（追記）として残す
- “上書き更新”が必要な場合でも、別途イベントログで必ず追跡可能にする
